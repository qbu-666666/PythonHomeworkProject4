{% extends "base.html" %}
{% block title %}最新文章{% endblock %}

{% block content %}
<h2>最新文章</h2>

{% if user.is_authenticated %}
<p style="text-align: right;">
    <a href="{% url 'blog:post_new' %}">+ 发布新文章</a>
</p>
{% endif %}

{% for post in posts %}
<div style="margin-bottom: 30px; padding: 15px; border-bottom: 1px solid #eee;">
    {% if post.cover_image %}
        <img src="{{ post.cover_image.url }}" alt="{{ post.title }}" style="max-width: 300px; height: auto; float: left; margin-right: 15px;">
    {% endif %}
    <h3><a href="{% url 'blog:post_detail' post.pk %}">{{ post.title }}</a></h3>
    <p>作者：{{ post.owner }} | 发布时间：{{ post.date_added|date:"Y-m-d H:i" }} | 浏览量：{{ post.views }}</p>
    <div style="clear: both;"></div>
</div>
{% empty %}
<p>暂无文章。</p>
{% endfor %}

<!-- 分页 -->
{% if is_paginated %}
<div style="text-align: center; margin: 20px 0;">
    {% if page_obj.has_previous %}
        <a href="?page=1">第一页</a> |
        <a href="?page={{ page_obj.previous_page_number }}">上一页</a> |
    {% endif %}
    <span>第 {{ page_obj.number }} 页 / 共 {{ paginator.num_pages }} 页</span>
    {% if page_obj.has_next %}
        | <a href="?page={{ page_obj.next_page_number }}">下一页</a> |
        <a href="?page={{ paginator.num_pages }}">最后一页</a>
    {% endif %}
</div>
{% endif %}

{% endblock %}